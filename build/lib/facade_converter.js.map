{"version":3,"sources":["facade_converter.ts"],"names":["FacadeConverter","FacadeConverter.constructor","FacadeConverter.extractPropertyNames","FacadeConverter.setTypeChecker","FacadeConverter.maybeHandleCall","FacadeConverter.handlePropertyAccess","FacadeConverter.visitTypeName","FacadeConverter.getHandler","FacadeConverter.getFileAndName","FacadeConverter.isNamedType","FacadeConverter.reportMissingType","FacadeConverter.isInsideConstExpr","FacadeConverter.isConstCall","FacadeConverter.emitCall"],"mappings":";;;;;;AAAA,uEAAuE;AACvE,IAAO,IAAI,WAAW,QAAQ,CAAC,CAAC;AAChC,IAAO,EAAE,WAAW,YAAY,CAAC,CAAC;AAMlC,IAAM,YAAY,GAAG,KAAK,CAAC;AAE3B;IAAqCA,mCAAmBA;IAKtDA,yBAAYA,UAA8BA;QAL5CC,iBA4VCA;QAtVGA,kBAAMA,UAAUA,CAACA,CAACA;QAJZA,wBAAmBA,GAAsCA,EAAEA,CAACA;QAC5DA,mBAAcA,GAAkCA,EAAEA,CAACA;QAwKnDA,2BAAsBA,GAAmBA;YAC/CA,MAAMA,EAAEA,UAAUA;YAClBA,OAAOA,EAAEA,MAAMA;YACfA,gBAAgBA,EAAEA,aAAaA;YAE/BA,+CAA+CA;YAC/CA,iDAAiDA;YACjDA,MAAMA,EAAEA,SAASA;YACjBA,MAAMA,EAAEA,SAASA;YACjBA,SAASA,EAAEA,SAASA;YACpBA,aAAaA,EAAEA,SAASA;YACxBA,kBAAkBA,EAAEA,SAASA;YAC7BA,kBAAkBA,EAAEA,SAASA;YAC7BA,cAAcA,EAAEA,SAASA;YACzBA,SAASA,EAAEA,SAASA;YACpBA,UAAUA,EAAEA,SAASA;SACtBA,CAACA;QAEMA,yBAAoBA,GAA2BA;YACrDA,KAAKA,EAAEA,IAAIA,CAACA,sBAAsBA;YAClCA,SAASA,EAAEA,IAAIA,CAACA,sBAAsBA;YACtCA,2BAA2BA,EACvBA,EAACA,SAASA,EAAEA,QAAQA,EAAEA,YAAYA,EAAEA,QAAQA,EAAEA,sBAAsBA,EAAEA,kBAAkBA,EAACA;YAC7FA,gCAAgCA,EAAEA,EAACA,WAAWA,EAAEA,KAAKA,EAACA;YACtDA,0BAA0BA,EAAEA,EAACA,MAAMA,EAAEA,UAAUA,EAACA;YAChDA,kBAAkBA,EAAEA,EAACA,WAAWA,EAAEA,KAAKA,EAACA;SACzCA,CAACA;QAEMA,mBAAcA,GAAwBA;YAC5CA,YAAYA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBACzDA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,KAAIA,CAACA,QAAQA,CAACA,KAAKA,EAAEA,CAACA,CAACA,SAASA,CAACA,CAACA;YACpCA,CAACA;YACDA,WAAWA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBACxDA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,KAAIA,CAACA,QAAQA,CAACA,YAAYA,CAACA,CAACA;YAC9BA,CAACA;YACDA,aAAaA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBAC1DA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,KAAIA,CAACA,IAAIA,CAACA,kBAAkBA,CAACA,CAACA;YAChCA,CAACA;YACDA,eAAeA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBAC5DA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;gBACfA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,EAAEA,CAACA,CAACA,CAACA,CAACA,SAASA,CAACA,MAAMA,IAAIA,CAACA,CAACA,CAACA,CAACA;oBAC5BA,KAAIA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA;oBAC5BA,KAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,SAASA,CAACA,CAACA,CAACA,CAACA,CAACA;oBAC3BA,KAAIA,CAACA,IAAIA,CAACA,cAAcA,CAACA,CAACA;gBAC5BA,CAACA;gBAACA,IAAIA,CAACA,CAACA;oBACNA,KAAIA,CAACA,IAAIA,CAACA,qBAAqBA,CAACA,CAACA;oBACjCA,KAAIA,CAACA,SAASA,CAACA,CAACA,CAACA,SAASA,CAACA,CAACA;oBAC5BA,KAAIA,CAACA,IAAIA,CAACA,eAAeA,CAACA,CAACA;gBAC7BA,CAACA;YACHA,CAACA;YACDA,WAAWA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBACxDA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,KAAIA,CAACA,QAAQA,CAACA,KAAKA,EAAEA,CAACA,CAACA,SAASA,CAACA,CAACA;gBAClCA,KAAIA,CAACA,QAAQA,CAACA,QAAQA,CAACA,CAACA;YAC1BA,CAACA;YACDA,aAAaA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBAC1DA,KAAIA,CAACA,QAAQA,CAACA,mBAAmBA,EAAEA,CAACA,OAAOA,SAAKA,CAACA,CAACA,SAASA,CAACA,CAACA,CAACA;YAChEA,CAACA;YACDA,cAAcA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBAC3DA,KAAIA,CAACA,QAAQA,CAACA,oBAAoBA,EAAEA,CAACA,OAAOA,SAAKA,CAACA,CAACA,SAASA,CAACA,CAACA,CAACA;YACjEA,CAACA;YACDA,cAAcA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBAC3DA,KAAIA,CAACA,IAAIA,CAACA,mBAAmBA,CAACA,CAACA;gBAC/BA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;gBACfA,CAACA,CAACA,SAASA,CAACA,OAAOA,CAACA,UAAAA,GAAGA;oBACrBA,EAAEA,CAACA,CAACA,CAACA,KAAIA,CAACA,WAAWA,CAACA,GAAGA,EAAEA,KAAKA,EAAEA,OAAOA,CAACA,CAACA,CAACA,CAACA;wBAC3CA,KAAIA,CAACA,WAAWA,CAACA,GAAGA,EAAEA,yCAAyCA,CAACA,CAACA;oBACnEA,CAACA;oBACDA,KAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,CAACA;oBACzBA,KAAIA,CAACA,KAAKA,CAACA,GAAGA,CAACA,CAACA;oBAChBA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;gBACjBA,CAACA,CAACA,CAACA;YACLA,CAACA;YACDA,0BAA0BA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBACvEA,KAAIA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA;gBACjBA,KAAIA,CAACA,SAASA,CAACA,CAACA,CAACA,SAASA,CAACA,EAAGA,oBAAoBA;gBAClDA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;gBACfA,KAAIA,CAACA,IAAIA,CAACA,SAASA,CAACA,CAACA;gBACrBA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;YACjBA,CAACA;YACDA,aAAaA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBAC1DA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,KAAIA,CAACA,QAAQA,CAACA,UAAUA,EAAEA,CAACA,CAACA,SAASA,CAACA,CAACA;YACzCA,CAACA;YACDA,aAAaA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;gBAC1DA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBACpBA,KAAIA,CAACA,QAAQA,CAACA,YAAYA,EAAEA,CAACA,CAACA,SAASA,CAACA,CAACA;gBACzCA,KAAIA,CAACA,QAAQA,CAACA,QAAQA,CAACA,CAACA;YAC1BA,CAACA;SACFA,CAACA;QAEMA,iBAAYA,GAAgCA;YAClDA,KAAKA,EAAEA,IAAIA,CAACA,cAAcA;YAC1BA,SAASA,EAAEA,IAAIA,CAACA,cAAcA;YAC9BA,gCAAgCA,EAAEA;gBAChCA,KAAKA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;oBAClDA,+DAA+DA;oBAC/DA,EAAEA,CAACA,CAACA,CAACA,KAAIA,CAACA,iBAAiBA,CAACA,CAACA,CAACA,CAACA;wBAACA,MAAMA,CAACA,IAAIA,CAACA;oBAC5CA,EAAEA,CAACA,CAACA,CAACA,CAACA,SAASA,CAACA,MAAMA,CAACA,CAACA,CAACA;wBACvBA,KAAIA,CAACA,WAAWA,CAACA,CAACA,EAAEA,2DAA2DA,CAACA,CAACA;oBACnFA,CAACA;oBACDA,EAAEA,CAACA,CAACA,CAACA,CAACA,aAAaA,CAACA,CAACA,CAACA;wBACpBA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;wBACfA,KAAIA,CAACA,SAASA,CAACA,CAACA,CAACA,aAAaA,CAACA,CAACA;wBAChCA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;oBACjBA,CAACA;oBACDA,KAAIA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA;oBACjBA,MAAMA,CAACA,KAAKA,CAACA;gBACfA,CAACA;aACFA;YACDA,0BAA0BA,EAAEA;gBAC1BA,SAASA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;oBACtDA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;oBACpBA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;oBACfA,KAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,SAASA,CAACA,CAACA,CAACA,CAACA,CAACA;oBAC3BA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;oBACfA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;oBACfA,KAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,SAASA,CAACA,CAACA,CAACA,CAACA,CAACA;gBAC7BA,CAACA;gBACDA,SAASA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;oBACtDA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;oBACpBA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;oBACfA,KAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,SAASA,CAACA,CAACA,CAACA,CAACA,CAACA;oBAC3BA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;gBACjBA,CAACA;gBACDA,SAASA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;oBACtDA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;oBACpBA,KAAIA,CAACA,QAAQA,CAACA,aAAaA,EAAEA,CAACA,CAACA,SAASA,CAACA,CAACA;gBAC5CA,CAACA;gBACDA,YAAYA,EAAEA,UAACA,CAAoBA,EAAEA,OAAsBA;oBACzDA,6DAA6DA;oBAC7DA,cAAcA;oBACdA,0DAA0DA;oBAC1DA,qEAAqEA;oBACrEA,0BAA0BA;oBAC1BA,KAAIA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;oBACfA,KAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;oBA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","file":"facade_converter.js","sourcesContent":["/// <reference path='../node_modules/typescript/bin/typescript.d.ts' />\nimport base = require('./base');\nimport ts = require('typescript');\nimport ts2dart = require('./main');\n\ntype CallHandler = (c: ts.CallExpression, context: ts.Expression) => void;\ntype PropertyHandler = (c: ts.PropertyAccessExpression) => void;\n\nconst FACADE_DEBUG = false;\n\nexport class FacadeConverter extends base.TranspilerBase {\n  private tc: ts.TypeChecker;\n  private candidateProperties: {[propertyName: string]: boolean} = {};\n  private candidateTypes: {[typeName: string]: boolean} = {};\n\n  constructor(transpiler: ts2dart.Transpiler) {\n    super(transpiler);\n    this.extractPropertyNames(this.callHandlers);\n    this.extractPropertyNames(this.propertyHandlers);\n    this.extractPropertyNames(this.TS_TO_DART_TYPENAMES, this.candidateTypes);\n  }\n\n  private extractPropertyNames(m: ts.Map<ts.Map<any>>,\n                               candidates: {[k: string]: boolean} = this.candidateProperties) {\n    for (var fileName in m) {\n      Object.keys(m[fileName])\n          .filter((k) => m[fileName].hasOwnProperty(k))\n          .map((propName) => propName.substring(propName.lastIndexOf('.') + 1))\n          .forEach((propName) => candidates[propName] = true);\n    }\n  }\n\n  setTypeChecker(tc: ts.TypeChecker) { this.tc = tc; }\n\n  maybeHandleCall(c: ts.CallExpression): boolean {\n    if (!this.tc) return false;\n\n    var symbol: ts.Symbol;\n    var context: ts.Expression;\n    var ident: string;\n\n    if (c.expression.kind === ts.SyntaxKind.Identifier) {\n      // Function call.\n      ident = base.ident(c.expression);\n      if (!this.candidateProperties.hasOwnProperty(ident)) return false;\n      symbol = this.tc.getSymbolAtLocation(c.expression);\n      if (FACADE_DEBUG) console.log('s:', symbol);\n\n      if (!symbol) {\n        this.reportMissingType(c, ident);\n        return false;\n      }\n\n      context = null;\n    } else if (c.expression.kind === ts.SyntaxKind.PropertyAccessExpression) {\n      // Method call.\n      var pa = <ts.PropertyAccessExpression>c.expression;\n      ident = base.ident(pa.name);\n      if (!this.candidateProperties.hasOwnProperty(ident)) return false;\n\n      symbol = this.tc.getSymbolAtLocation(pa);\n      if (FACADE_DEBUG) console.log('s:', symbol);\n\n      // Error will be reported by PropertyAccess handling below.\n      if (!symbol) return false;\n\n      context = pa.expression;\n    } else {\n      // Not a call we recognize.\n      return false;\n    }\n\n    var handler = this.getHandler(symbol, this.callHandlers);\n    return handler && !handler(c, context);\n  }\n\n  handlePropertyAccess(pa: ts.PropertyAccessExpression): boolean {\n    if (!this.tc) return;\n    var ident = pa.name.text;\n    if (!this.candidateProperties.hasOwnProperty(ident)) return false;\n    var symbol = this.tc.getSymbolAtLocation(pa.name);\n    if (!symbol) {\n      this.reportMissingType(pa, ident);\n      return false;\n    }\n\n    var handler = this.getHandler(symbol, this.propertyHandlers);\n    return handler && !handler(pa);\n  }\n\n  visitTypeName(typeName: ts.EntityName) {\n    if (typeName.kind !== ts.SyntaxKind.Identifier) {\n      this.visit(typeName);\n      return;\n    }\n    var ident = base.ident(typeName);\n    if (this.candidateTypes.hasOwnProperty(ident) && this.tc) {\n      var symbol = this.tc.getSymbolAtLocation(typeName);\n      if (!symbol) {\n        this.reportMissingType(typeName, ident);\n        return;\n      }\n      let fileAndName = this.getFileAndName(symbol);\n      if (fileAndName) {\n        var fileSubs = this.TS_TO_DART_TYPENAMES[fileAndName.fileName];\n        if (fileSubs && fileSubs.hasOwnProperty(fileAndName.qname)) {\n          this.emit(fileSubs[fileAndName.qname]);\n          return;\n        }\n      }\n    }\n    this.emit(ident);\n  }\n\n  private getHandler<T>(symbol: ts.Symbol, m: ts.Map<ts.Map<T>>): T {\n    var {fileName, qname} = this.getFileAndName(symbol);\n    var fileSubs = m[fileName];\n    if (!fileSubs) return null;\n    return fileSubs[qname];\n  }\n\n  private getFileAndName(symbol: ts.Symbol): {fileName: string, qname: string} {\n    while (symbol.flags & ts.SymbolFlags.Alias) symbol = this.tc.getAliasedSymbol(symbol);\n    let decl = symbol.valueDeclaration;\n    if (!decl) {\n      // In the case of a pure declaration with no assignment, there is no value declared.\n      // Just grab the first declaration, hoping it is declared once.\n      decl = symbol.declarations[0];\n    }\n\n    var fileName = decl.getSourceFile().fileName;\n    fileName = this.getRelativeFileName(fileName);\n    fileName = fileName.replace(/(\\.d)?\\.ts$/, '');\n\n    if (FACADE_DEBUG) console.log('fn:', fileName);\n    var qname = this.tc.getFullyQualifiedName(symbol);\n    // Some Qualified Names include their file name. Might be a bug in TypeScript,\n    // for the time being just special case.\n    if (symbol.flags & ts.SymbolFlags.Function || symbol.flags & ts.SymbolFlags.Variable ||\n        symbol.flags & ts.SymbolFlags.Class) {\n      qname = symbol.getName();\n    }\n    if (FACADE_DEBUG) console.log('qn:', qname);\n    return {fileName, qname};\n  }\n\n  private isNamedType(node: ts.Node, fileName: string, qname: string): boolean {\n    var symbol = this.tc.getTypeAtLocation(node).getSymbol();\n    if (!symbol) return false;\n    var actual = this.getFileAndName(symbol);\n    if (fileName === 'lib' && !(actual.fileName === 'lib' || actual.fileName === 'lib.es6')) {\n      return false;\n    } else {\n      if (fileName !== actual.fileName) return false;\n    }\n    return qname === actual.qname;\n  }\n\n  private reportMissingType(n: ts.Node, ident: string) {\n    this.reportError(n, `Untyped property access to \"${ident}\" which could be ` +\n                            `a special ts2dart builtin. ` +\n                            `Please add type declarations to disambiguate.`);\n  }\n\n  isInsideConstExpr(node: ts.Node): boolean {\n    return this.isConstCall(\n        <ts.CallExpression>this.getAncestor(node, ts.SyntaxKind.CallExpression));\n  }\n\n  private isConstCall(node: ts.CallExpression): boolean {\n    return node && base.ident(node.expression) === 'CONST_EXPR';\n  }\n\n  private emitCall(name: string, args?: ts.Expression[]) {\n    this.emit('.');\n    this.emit(name);\n    this.emit('(');\n    if (args) this.visitList(args);\n    this.emit(')');\n  }\n\n  private stdlibTypeReplacements: ts.Map<string> = {\n    'Date': 'DateTime',\n    'Array': 'List',\n    'XMLHttpRequest': 'HttpRequest',\n\n    // Dart has two different incompatible DOM APIs\n    // https://github.com/angular/angular/issues/2770\n    'Node': 'dynamic',\n    'Text': 'dynamic',\n    'Element': 'dynamic',\n    'HTMLElement': 'dynamic',\n    'HTMLStyleElement': 'dynamic',\n    'HTMLInputElement': 'dynamic',\n    'HTMLDocument': 'dynamic',\n    'History': 'dynamic',\n    'Location': 'dynamic',\n  };\n\n  private TS_TO_DART_TYPENAMES: ts.Map<ts.Map<string>> = {\n    'lib': this.stdlibTypeReplacements,\n    'lib.es6': this.stdlibTypeReplacements,\n    'angular2/src/facade/async':\n        {'Promise': 'Future', 'Observable': 'Stream', 'ObservableController': 'StreamController'},\n    'angular2/src/facade/collection': {'StringMap': 'Map'},\n    'angular2/src/facade/lang': {'Date': 'DateTime'},\n    'angular2/globals': {'StringMap': 'Map'},\n  };\n\n  private stdlibHandlers: ts.Map<CallHandler> = {\n    'Array.push': (c: ts.CallExpression, context: ts.Expression) => {\n      this.visit(context);\n      this.emitCall('add', c.arguments);\n    },\n    'Array.pop': (c: ts.CallExpression, context: ts.Expression) => {\n      this.visit(context);\n      this.emitCall('removeLast');\n    },\n    'Array.shift': (c: ts.CallExpression, context: ts.Expression) => {\n      this.visit(context);\n      this.emit('. removeAt ( 0 )');\n    },\n    'Array.unshift': (c: ts.CallExpression, context: ts.Expression) => {\n      this.emit('(');\n      this.visit(context);\n      if (c.arguments.length == 1) {\n        this.emit('.. insert ( 0,');\n        this.visit(c.arguments[0]);\n        this.emit(') ) . length');\n      } else {\n        this.emit('.. insertAll ( 0, [');\n        this.visitList(c.arguments);\n        this.emit(']) ) . length');\n      }\n    },\n    'Array.map': (c: ts.CallExpression, context: ts.Expression) => {\n      this.visit(context);\n      this.emitCall('map', c.arguments);\n      this.emitCall('toList');\n    },\n    'Array.slice': (c: ts.CallExpression, context: ts.Expression) => {\n      this.emitCall('ListWrapper.slice', [context, ...c.arguments]);\n    },\n    'Array.splice': (c: ts.CallExpression, context: ts.Expression) => {\n      this.emitCall('ListWrapper.splice', [context, ...c.arguments]);\n    },\n    'Array.concat': (c: ts.CallExpression, context: ts.Expression) => {\n      this.emit('new List . from (');\n      this.visit(context);\n      this.emit(')');\n      c.arguments.forEach(arg => {\n        if (!this.isNamedType(arg, 'lib', 'Array')) {\n          this.reportError(arg, 'Array.concat only takes Array arguments');\n        }\n        this.emit('.. addAll (');\n        this.visit(arg);\n        this.emit(')');\n      });\n    },\n    'ArrayConstructor.isArray': (c: ts.CallExpression, context: ts.Expression) => {\n      this.emit('( (');\n      this.visitList(c.arguments);  // Should only be 1.\n      this.emit(')');\n      this.emit('is List');\n      this.emit(')');\n    },\n    'RegExp.test': (c: ts.CallExpression, context: ts.Expression) => {\n      this.visit(context);\n      this.emitCall('hasMatch', c.arguments);\n    },\n    'RegExp.exec': (c: ts.CallExpression, context: ts.Expression) => {\n      this.visit(context);\n      this.emitCall('allMatches', c.arguments);\n      this.emitCall('toList');\n    },\n  };\n\n  private callHandlers: ts.Map<ts.Map<CallHandler>> = {\n    'lib': this.stdlibHandlers,\n    'lib.es6': this.stdlibHandlers,\n    'angular2/src/facade/collection': {\n      'Map': (c: ts.CallExpression, context: ts.Expression): boolean => {\n        // The actual Map constructor is special cased for const calls.\n        if (!this.isInsideConstExpr(c)) return true;\n        if (c.arguments.length) {\n          this.reportError(c, 'Arguments on a Map constructor in a const are unsupported');\n        }\n        if (c.typeArguments) {\n          this.emit('<');\n          this.visitList(c.typeArguments);\n          this.emit('>');\n        }\n        this.emit('{ }');\n        return false;\n      },\n    },\n    'angular2/traceur-runtime': {\n      'Map.set': (c: ts.CallExpression, context: ts.Expression) => {\n        this.visit(context);\n        this.emit('[');\n        this.visit(c.arguments[0]);\n        this.emit(']');\n        this.emit('=');\n        this.visit(c.arguments[1]);\n      },\n      'Map.get': (c: ts.CallExpression, context: ts.Expression) => {\n        this.visit(context);\n        this.emit('[');\n        this.visit(c.arguments[0]);\n        this.emit(']');\n      },\n      'Map.has': (c: ts.CallExpression, context: ts.Expression) => {\n        this.visit(context);\n        this.emitCall('containsKey', c.arguments);\n      },\n      'Map.delete': (c: ts.CallExpression, context: ts.Expression) => {\n        // JS Map.delete(k) returns whether k was present in the map,\n        // convert to:\n        // (Map.containsKey(k) && (Map.remove(k) != null || true))\n        // (Map.remove(k) != null || true) is required to always returns true\n        // when Map.containsKey(k)\n        this.emit('(');\n        this.visit(context);\n        this.emitCall('containsKey', c.arguments);\n        this.emit('&& (');\n        this.visit(context);\n        this.emitCall('remove', c.arguments);\n        this.emit('!= null || true ) )');\n      },\n    },\n    'angular2/src/di/forward_ref': {\n      'forwardRef': (c: ts.CallExpression, context: ts.Expression) => {\n        // The special function forwardRef translates to an unwrapped value in Dart.\n        const callback = <ts.FunctionExpression>c.arguments[0];\n        if (callback.kind !== ts.SyntaxKind.ArrowFunction) {\n          this.reportError(c, 'forwardRef takes only arrow functions');\n          return;\n        }\n        this.visit(callback.body);\n      },\n    },\n    'angular2/src/facade/lang': {\n      'CONST_EXPR': (c: ts.CallExpression, context: ts.Expression) => {\n        // `const` keyword is emitted in the array literal handling, as it needs to be transitive.\n        this.visitList(c.arguments);\n      },\n    },\n  };\n\n  private propertyHandlers: ts.Map<ts.Map<PropertyHandler>> = {\n    'angular2/traceur-runtime': {\n      'Map.size': (p: ts.PropertyAccessExpression) => {\n        this.visit(p.expression);\n        this.emit('.');\n        this.emit('length');\n      },\n    },\n  };\n}\n"],"sourceRoot":"/source/"}