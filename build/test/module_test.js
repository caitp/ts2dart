/// <reference path="../typings/mocha/mocha.d.ts"/>
var chai = require('chai');
var main = require('../lib/main');
var module_1 = require('../lib/module');
var facade_converter_1 = require('../lib/facade_converter');
var test_support_1 = require('./test_support');
describe('imports', function () {
    it('translates import equals statements', function () {
        test_support_1.expectTranslate('import x = require("y");').to.equal(' import "package:y.dart" as x ;');
    });
    it('translates import from statements', function () {
        test_support_1.expectTranslate('import {x,y} from "z";').to.equal(' import "package:z.dart" show x , y ;');
    });
    it('translates import star', function () {
        test_support_1.expectTranslate('import * as foo from "z";').to.equal(' import "package:z.dart" as foo ;');
    });
    it('allows import dart file from relative path', function () {
        test_support_1.expectTranslate('import x = require("./y")').to.equal(' import "y.dart" as x ;');
        test_support_1.expectTranslate('import {x} from "./y"').to.equal(' import "y.dart" show x ;');
        test_support_1.expectTranslate('import {x} from "../y"').to.equal(' import "../y.dart" show x ;');
    });
    it('handles ignored annotations in imports', function () {
        test_support_1.expectTranslate('import {CONST, CONST_EXPR, IMPLEMENTS, ABSTRACT} from "x"').to.equal('');
        test_support_1.expectTranslate('import {x, IMPLEMENTS} from "./x"').to.equal(' import "x.dart" show x ;');
    });
    it('fails for renamed imports', function () {
        test_support_1.expectErroneousCode('import {Foo as Bar} from "baz";')
            .to.throw(/import\/export renames are unsupported in Dart/);
    });
    it('fails for empty import specs', function () { test_support_1.expectErroneousCode('import {} from "baz";').to.throw(/empty import list/); });
});
describe('exports', function () {
    // Dart exports are implicit, everything non-private is exported by the library.
    it('allows variable exports', function () { test_support_1.expectTranslate('export var x = 12;').to.equal(' var x = 12 ;'); });
    it('allows class exports', function () { test_support_1.expectTranslate('export class X {}').to.equal(' class X { }'); });
    it('allows export declarations', function () { test_support_1.expectTranslate('export * from "X";').to.equal(' export "package:X.dart" ;'); });
    it('allows export declarations', function () { test_support_1.expectTranslate('export * from "./X";').to.equal(' export "X.dart" ;'); });
    it('allows named export declarations', function () {
        test_support_1.expectTranslate('export {a, b} from "X";').to.equal(' export "package:X.dart" show a , b ;');
    });
    it('fails for renamed exports', function () {
        test_support_1.expectErroneousCode('export {Foo as Bar} from "baz";')
            .to.throw(/import\/export renames are unsupported in Dart/);
    });
    it('fails for exports without URLs', function () {
        test_support_1.expectErroneousCode('export {a as b};').to.throw('re-exports must have a module URL');
    });
    it('fails for empty export specs', function () { test_support_1.expectErroneousCode('export {} from "baz";').to.throw(/empty export list/); });
});
describe('library name', function () {
    var transpiler;
    var modTranspiler;
    beforeEach(function () {
        transpiler = new main.Transpiler({ failFast: true, generateLibraryName: true, basePath: '/a' });
        modTranspiler = new module_1["default"](transpiler, new facade_converter_1.FacadeConverter(transpiler), true);
    });
    it('adds a library name', function () {
        var results = test_support_1.translateSources({ '/a/b/c.ts': 'var x;' }, { failFast: true, generateLibraryName: true, basePath: '/a' });
        chai.expect(results['/a/b/c.ts']).to.equal(' library b.c ; var x ;');
    });
    it('leaves relative paths alone', function () { chai.expect(modTranspiler.getLibraryName('a/b')).to.equal('a.b'); });
    it('handles reserved words', function () {
        chai.expect(modTranspiler.getLibraryName('/a/for/in/do/x')).to.equal('_for._in._do.x');
    });
    it('handles built-in and limited keywords', function () {
        chai.expect(modTranspiler.getLibraryName('/a/as/if/sync/x')).to.equal('as._if.sync.x');
    });
    it('handles file extensions', function () {
        chai.expect(modTranspiler.getLibraryName('a/x.ts')).to.equal('a.x');
        chai.expect(modTranspiler.getLibraryName('a/x.js')).to.equal('a.x');
    });
    it('handles non word characters', function () { chai.expect(modTranspiler.getLibraryName('a/%x.ts')).to.equal('a._x'); });
});

//# sourceMappingURL=data:application/json;base64,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QUssQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN0RSxDQUFDLENBQUMsQ0FBQztJQUNILEVBQUUsQ0FBQyw2QkFBNkIsRUFDN0IsY0FBUSxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdkYsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9tb2R1bGVfdGVzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBpbmdzL21vY2hhL21vY2hhLmQudHNcIi8+XG5pbXBvcnQgY2hhaSA9IHJlcXVpcmUoJ2NoYWknKTtcbmltcG9ydCBtYWluID0gcmVxdWlyZSgnLi4vbGliL21haW4nKTtcbmltcG9ydCBNb2R1bGVUcmFuc3BpbGVyIGZyb20gJy4uL2xpYi9tb2R1bGUnO1xuaW1wb3J0IHtGYWNhZGVDb252ZXJ0ZXJ9IGZyb20gJy4uL2xpYi9mYWNhZGVfY29udmVydGVyJztcblxuaW1wb3J0IHtleHBlY3RUcmFuc2xhdGUsIGV4cGVjdEVycm9uZW91c0NvZGUsIHRyYW5zbGF0ZVNvdXJjZXN9IGZyb20gJy4vdGVzdF9zdXBwb3J0JztcblxuZGVzY3JpYmUoJ2ltcG9ydHMnLCAoKSA9PiB7XG4gIGl0KCd0cmFuc2xhdGVzIGltcG9ydCBlcXVhbHMgc3RhdGVtZW50cycsICgpID0+IHtcbiAgICBleHBlY3RUcmFuc2xhdGUoJ2ltcG9ydCB4ID0gcmVxdWlyZShcInlcIik7JykudG8uZXF1YWwoJyBpbXBvcnQgXCJwYWNrYWdlOnkuZGFydFwiIGFzIHggOycpO1xuICB9KTtcbiAgaXQoJ3RyYW5zbGF0ZXMgaW1wb3J0IGZyb20gc3RhdGVtZW50cycsICgpID0+IHtcbiAgICBleHBlY3RUcmFuc2xhdGUoJ2ltcG9ydCB7eCx5fSBmcm9tIFwielwiOycpLnRvLmVxdWFsKCcgaW1wb3J0IFwicGFja2FnZTp6LmRhcnRcIiBzaG93IHggLCB5IDsnKTtcbiAgfSk7XG4gIGl0KCd0cmFuc2xhdGVzIGltcG9ydCBzdGFyJywgKCkgPT4ge1xuICAgIGV4cGVjdFRyYW5zbGF0ZSgnaW1wb3J0ICogYXMgZm9vIGZyb20gXCJ6XCI7JykudG8uZXF1YWwoJyBpbXBvcnQgXCJwYWNrYWdlOnouZGFydFwiIGFzIGZvbyA7Jyk7XG4gIH0pO1xuICBpdCgnYWxsb3dzIGltcG9ydCBkYXJ0IGZpbGUgZnJvbSByZWxhdGl2ZSBwYXRoJywgKCkgPT4ge1xuICAgIGV4cGVjdFRyYW5zbGF0ZSgnaW1wb3J0IHggPSByZXF1aXJlKFwiLi95XCIpJykudG8uZXF1YWwoJyBpbXBvcnQgXCJ5LmRhcnRcIiBhcyB4IDsnKTtcbiAgICBleHBlY3RUcmFuc2xhdGUoJ2ltcG9ydCB7eH0gZnJvbSBcIi4veVwiJykudG8uZXF1YWwoJyBpbXBvcnQgXCJ5LmRhcnRcIiBzaG93IHggOycpO1xuICAgIGV4cGVjdFRyYW5zbGF0ZSgnaW1wb3J0IHt4fSBmcm9tIFwiLi4veVwiJykudG8uZXF1YWwoJyBpbXBvcnQgXCIuLi95LmRhcnRcIiBzaG93IHggOycpO1xuICB9KTtcbiAgaXQoJ2hhbmRsZXMgaWdub3JlZCBhbm5vdGF0aW9ucyBpbiBpbXBvcnRzJywgKCkgPT4ge1xuICAgIGV4cGVjdFRyYW5zbGF0ZSgnaW1wb3J0IHtDT05TVCwgQ09OU1RfRVhQUiwgSU1QTEVNRU5UUywgQUJTVFJBQ1R9IGZyb20gXCJ4XCInKS50by5lcXVhbCgnJyk7XG4gICAgZXhwZWN0VHJhbnNsYXRlKCdpbXBvcnQge3gsIElNUExFTUVOVFN9IGZyb20gXCIuL3hcIicpLnRvLmVxdWFsKCcgaW1wb3J0IFwieC5kYXJ0XCIgc2hvdyB4IDsnKTtcbiAgfSk7XG4gIGl0KCdmYWlscyBmb3IgcmVuYW1lZCBpbXBvcnRzJywgKCkgPT4ge1xuICAgIGV4cGVjdEVycm9uZW91c0NvZGUoJ2ltcG9ydCB7Rm9vIGFzIEJhcn0gZnJvbSBcImJhelwiOycpXG4gICAgICAgIC50by50aHJvdygvaW1wb3J0XFwvZXhwb3J0IHJlbmFtZXMgYXJlIHVuc3VwcG9ydGVkIGluIERhcnQvKTtcbiAgfSk7XG4gIGl0KCdmYWlscyBmb3IgZW1wdHkgaW1wb3J0IHNwZWNzJyxcbiAgICAgKCkgPT4geyBleHBlY3RFcnJvbmVvdXNDb2RlKCdpbXBvcnQge30gZnJvbSBcImJhelwiOycpLnRvLnRocm93KC9lbXB0eSBpbXBvcnQgbGlzdC8pOyB9KTtcbn0pO1xuXG5kZXNjcmliZSgnZXhwb3J0cycsICgpID0+IHtcbiAgLy8gRGFydCBleHBvcnRzIGFyZSBpbXBsaWNpdCwgZXZlcnl0aGluZyBub24tcHJpdmF0ZSBpcyBleHBvcnRlZCBieSB0aGUgbGlicmFyeS5cbiAgaXQoJ2FsbG93cyB2YXJpYWJsZSBleHBvcnRzJyxcbiAgICAgKCkgPT4geyBleHBlY3RUcmFuc2xhdGUoJ2V4cG9ydCB2YXIgeCA9IDEyOycpLnRvLmVxdWFsKCcgdmFyIHggPSAxMiA7Jyk7IH0pO1xuICBpdCgnYWxsb3dzIGNsYXNzIGV4cG9ydHMnLFxuICAgICAoKSA9PiB7IGV4cGVjdFRyYW5zbGF0ZSgnZXhwb3J0IGNsYXNzIFgge30nKS50by5lcXVhbCgnIGNsYXNzIFggeyB9Jyk7IH0pO1xuICBpdCgnYWxsb3dzIGV4cG9ydCBkZWNsYXJhdGlvbnMnLFxuICAgICAoKSA9PiB7IGV4cGVjdFRyYW5zbGF0ZSgnZXhwb3J0ICogZnJvbSBcIlhcIjsnKS50by5lcXVhbCgnIGV4cG9ydCBcInBhY2thZ2U6WC5kYXJ0XCIgOycpOyB9KTtcbiAgaXQoJ2FsbG93cyBleHBvcnQgZGVjbGFyYXRpb25zJyxcbiAgICAgKCkgPT4geyBleHBlY3RUcmFuc2xhdGUoJ2V4cG9ydCAqIGZyb20gXCIuL1hcIjsnKS50by5lcXVhbCgnIGV4cG9ydCBcIlguZGFydFwiIDsnKTsgfSk7XG4gIGl0KCdhbGxvd3MgbmFtZWQgZXhwb3J0IGRlY2xhcmF0aW9ucycsICgpID0+IHtcbiAgICBleHBlY3RUcmFuc2xhdGUoJ2V4cG9ydCB7YSwgYn0gZnJvbSBcIlhcIjsnKS50by5lcXVhbCgnIGV4cG9ydCBcInBhY2thZ2U6WC5kYXJ0XCIgc2hvdyBhICwgYiA7Jyk7XG4gIH0pO1xuICBpdCgnZmFpbHMgZm9yIHJlbmFtZWQgZXhwb3J0cycsICgpID0+IHtcbiAgICBleHBlY3RFcnJvbmVvdXNDb2RlKCdleHBvcnQge0ZvbyBhcyBCYXJ9IGZyb20gXCJiYXpcIjsnKVxuICAgICAgICAudG8udGhyb3coL2ltcG9ydFxcL2V4cG9ydCByZW5hbWVzIGFyZSB1bnN1cHBvcnRlZCBpbiBEYXJ0Lyk7XG4gIH0pO1xuICBpdCgnZmFpbHMgZm9yIGV4cG9ydHMgd2l0aG91dCBVUkxzJywgKCkgPT4ge1xuICAgIGV4cGVjdEVycm9uZW91c0NvZGUoJ2V4cG9ydCB7YSBhcyBifTsnKS50by50aHJvdygncmUtZXhwb3J0cyBtdXN0IGhhdmUgYSBtb2R1bGUgVVJMJyk7XG4gIH0pO1xuICBpdCgnZmFpbHMgZm9yIGVtcHR5IGV4cG9ydCBzcGVjcycsXG4gICAgICgpID0+IHsgZXhwZWN0RXJyb25lb3VzQ29kZSgnZXhwb3J0IHt9IGZyb20gXCJiYXpcIjsnKS50by50aHJvdygvZW1wdHkgZXhwb3J0IGxpc3QvKTsgfSk7XG59KTtcblxuZGVzY3JpYmUoJ2xpYnJhcnkgbmFtZScsICgpID0+IHtcbiAgdmFyIHRyYW5zcGlsZXI6IG1haW4uVHJhbnNwaWxlcjtcbiAgdmFyIG1vZFRyYW5zcGlsZXI6IE1vZHVsZVRyYW5zcGlsZXI7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHRyYW5zcGlsZXIgPSBuZXcgbWFpbi5UcmFuc3BpbGVyKHtmYWlsRmFzdDogdHJ1ZSwgZ2VuZXJhdGVMaWJyYXJ5TmFtZTogdHJ1ZSwgYmFzZVBhdGg6ICcvYSd9KTtcbiAgICBtb2RUcmFuc3BpbGVyID0gbmV3IE1vZHVsZVRyYW5zcGlsZXIodHJhbnNwaWxlciwgbmV3IEZhY2FkZUNvbnZlcnRlcih0cmFuc3BpbGVyKSwgdHJ1ZSk7XG4gIH0pO1xuICBpdCgnYWRkcyBhIGxpYnJhcnkgbmFtZScsICgpID0+IHtcbiAgICB2YXIgcmVzdWx0cyA9IHRyYW5zbGF0ZVNvdXJjZXMoeycvYS9iL2MudHMnOiAndmFyIHg7J30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmYWlsRmFzdDogdHJ1ZSwgZ2VuZXJhdGVMaWJyYXJ5TmFtZTogdHJ1ZSwgYmFzZVBhdGg6ICcvYSd9KTtcbiAgICBjaGFpLmV4cGVjdChyZXN1bHRzWycvYS9iL2MudHMnXSkudG8uZXF1YWwoJyBsaWJyYXJ5IGIuYyA7IHZhciB4IDsnKTtcbiAgfSk7XG4gIGl0KCdsZWF2ZXMgcmVsYXRpdmUgcGF0aHMgYWxvbmUnLFxuICAgICAoKSA9PiB7IGNoYWkuZXhwZWN0KG1vZFRyYW5zcGlsZXIuZ2V0TGlicmFyeU5hbWUoJ2EvYicpKS50by5lcXVhbCgnYS5iJyk7IH0pO1xuICBpdCgnaGFuZGxlcyByZXNlcnZlZCB3b3JkcycsICgpID0+IHtcbiAgICBjaGFpLmV4cGVjdChtb2RUcmFuc3BpbGVyLmdldExpYnJhcnlOYW1lKCcvYS9mb3IvaW4vZG8veCcpKS50by5lcXVhbCgnX2Zvci5faW4uX2RvLngnKTtcbiAgfSk7XG4gIGl0KCdoYW5kbGVzIGJ1aWx0LWluIGFuZCBsaW1pdGVkIGtleXdvcmRzJywgKCkgPT4ge1xuICAgIGNoYWkuZXhwZWN0KG1vZFRyYW5zcGlsZXIuZ2V0TGlicmFyeU5hbWUoJy9hL2FzL2lmL3N5bmMveCcpKS50by5lcXVhbCgnYXMuX2lmLnN5bmMueCcpO1xuICB9KTtcbiAgaXQoJ2hhbmRsZXMgZmlsZSBleHRlbnNpb25zJywgKCkgPT4ge1xuICAgIGNoYWkuZXhwZWN0KG1vZFRyYW5zcGlsZXIuZ2V0TGlicmFyeU5hbWUoJ2EveC50cycpKS50by5lcXVhbCgnYS54Jyk7XG4gICAgY2hhaS5leHBlY3QobW9kVHJhbnNwaWxlci5nZXRMaWJyYXJ5TmFtZSgnYS94LmpzJykpLnRvLmVxdWFsKCdhLngnKTtcbiAgfSk7XG4gIGl0KCdoYW5kbGVzIG5vbiB3b3JkIGNoYXJhY3RlcnMnLFxuICAgICAoKSA9PiB7IGNoYWkuZXhwZWN0KG1vZFRyYW5zcGlsZXIuZ2V0TGlicmFyeU5hbWUoJ2EvJXgudHMnKSkudG8uZXF1YWwoJ2EuX3gnKTsgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==